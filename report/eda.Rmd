---
output: html_document
editor_options: 
  chunk_output_type: inline
---


```{r}
Smartphone_reviews <- read.csv(here::here("data/smartphone_reviews.csv"))
```


Creating a corpus
```{r}
Smartphone_reviews.cp <- corpus(Smartphone_reviews$Reviews)
```

Creating tokens
```{r}
Smartphone_reviews.tk <- tokens(
  Smartphone_reviews.cp,
  remove_punct = TRUE,
  remove_symbols = TRUE,
  remove_numbers = TRUE,
  remove_separators = TRUE
)
Smartphone_reviews.tk <- Smartphone_reviews.tk %>%
  tokens_tolower() %>%
  tokens_remove(stop_words$word)
```

DTM; TF-IDF and global frequency
```{r}
## Compute the DTM, TF-IDF and global frequencies
Smartphone_reviews.dfm <- dfm(Smartphone_reviews.tk)
Smartphone_reviews.tfidf <- dfm_tfidf(Smartphone_reviews.dfm)  
Smartphone_reviews.freq <- textstat_frequency(Smartphone_reviews.dfm)
```

ploting frequency

```{r}
Smartphone_reviews.freq %>% 
  top_n(20, frequency) %>%
  ggplot(aes(
    x = reorder(feature, frequency),
    y = frequency)) + 
  geom_bar(stat = "identity") + 
  coord_flip() +
  xlab("Frequency") + 
  ylab("term")
```

For document
```{r}
Smartphone_reviews.dfm %>% 
  tidy() %>% 
  group_by(document) %>% 
  top_n(5, count) %>% 
  ungroup() %>% 
  ggplot(aes(x = term, y = count)) + 
  geom_col() + coord_flip() + 
  theme(axis.text.y = element_text(size = 4),
        axis.ticks.y = element_blank())  + 
  facet_wrap(~document, ncol = 2, scales="free")
```

plotting TF-IDF
```{r}
Smartphone_reviews.tfidf %>% 
  tidy() %>% 
  top_n(20, count) %>% 
  ggplot(aes(x = term, y = count)) + 
  geom_col() + 
  coord_flip() + 
  theme(axis.text.y = element_text(size = 4),
        axis.ticks.y = element_blank())  + 
  facet_wrap(~document, ncol = 2)
```

Maximum TF_IDF per document

```{r}
Smartphone_reviews.tfidf %>% 
  tidy() %>%
  group_by(term) %>%
  summarize(count = max(count)) %>%
  ungroup() %>% 
  arrange(desc(count)) %>%
  top_n(20, count) %>%
  ggplot(aes(x=reorder(term, count),
             y = count)) + 
  geom_bar(stat = "identity") + 
  coord_flip() +
  xlab("Max TF-IDF") + 
  ylab("term")
```
Document log frequency
```{r}
Smartphone_reviews.freq %>% 
  ggplot(aes(x = log10(docfreq),
             y = log10(frequency))) + 
  geom_text(aes(label=feature),
            position=position_jitter(),
            size = 3) + 
  xlab("Document log-frequency") + 
  ylab("log-frequency")
```

